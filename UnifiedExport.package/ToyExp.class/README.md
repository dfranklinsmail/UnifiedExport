Implementing Remy's Type inference from http://okmij.org/ftp/ML/generalization.html